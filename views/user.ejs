<%- include("partials/headerWithSearch.ejs"); %>

<div class="profile-background">
<div class="userpage-container container">
  <section class="name-level-wrapper">
    <img src="<%= dataObj.persondata.avatarfull %>" alt="avatar" class="avatar">
    <div class="name-level">
      <h4>
        <a href="<%= dataObj.persondata.profileurl %>" target="_blank" title="<%= dataObj.persondata.personaname %> | <%= dataObj.persondata.profileurl %>">
          <i class="fas fa-link mr-1"></i>        
          <%= dataObj.persondata.personaname %>
      </a>
    </h4>
      <% if(dataObj.steamLvl){ %>
        <div class="friendPlayerLevel"><span class="friendPlayerLevelNum"><%= dataObj.steamLvl %></span></div>
      <% }else{ %>
        <div class="friendPlayerLevel"><span class="friendPlayerLevelNum">?</span></div>
      <% } %>
    </div>
    <% if(dataObj.persondata.realname){ %> 
      <div class="realname-profileurl">
        <p><%= dataObj.persondata.realname %></p>
     </div>
    <% }else{ %>
      <script>
      const wrapper = document.querySelector(".name-level-wrapper");
      wrapper.style.gridTemplateRows = "repeat(2,1fr)";
      </script> 
    <% } %>
    <div class="steam-rep">
      <a href="<%= dataObj.steamrepReputation.steamrepurl %>" title="SteamRep | <%= dataObj.persondata.personaname %> | <%= dataObj.steamrepReputation.steamrepurl %> " target="_blank" rel="no-follow">
        <i class="fas fa-link mr-1"></i> 
        <img src="/images/steamrep-logo.png" alt="steamrep">
      </a>
    </div>
  </section>
 <section class="about-wrapper">
    <div class="about">
      <h5 class="section-title" style="margin-bottom: 1.5rem;">
        ABOUT
      </h5>
      <table class="table">
        <% if(dataObj.steamLvl) { %>
        <tr>
          <td class="name-label">
            <strong>STEAM LEVEL</strong>
          </td>
          <td class="data-label">
            <span class="data">
              <%= dataObj.steamLvl %>
            </span>
          </td>
        </tr>
        <% }else{ %>
          <tr>
            <td class="name-label">
              <strong>STEAM LEVEL</strong>
            </td>
            <td class="data-label">
              <span class="data private">
                PRIVATE
              </span>
            </td>
          </tr>
        <% } %>
        <tr class="friendship">
          <td class="name-label">
            <strong>FRIENDSHIP</strong>
          </td>
          <td class="data-label">
            <span class="data mute">
              <em><a href="/auth/steam">Sign in to check</a></em>
            </span>
          </td>
        </tr>
        <% if(dataObj.persondata.timecreated) { %>
        <tr>
          <td class="name-label">
            <strong>JOINED STEAM</strong>
          </td>
          <td class="data-label">
            <% const humanDate = new Date(dataObj.persondata.timecreated*1000).toLocaleDateString("en-IN") %>
            <span class="data">
              <%= humanDate %>
            </span>
          </td>
        </tr>
        <% } else{ %>
          <tr>
            <td class="name-label">
              <strong>JOINED STEAM</strong>
            </td>
            <td class="data-label">
              <span class="data private">
                PRIVATE
              </span>
            </td>
          </tr>
        <% } %>
        <tr class="isonline">
          <td class="name-label">
            <strong>ONLINE STATUS</strong>
          </td>
          <td class="data-label">
            <span class="data" id="online-status"></span>
          </td>
        </tr>
      </table>
    </div>
    <hr style="margin-top: 0;">
    <div class="reputation-wrapper">
      <h5 class="section-title" style="margin-bottom: 1.5rem;">
        REPUTATION          
        <button class="rep-status" data-html="true" data-placement="right" data-toggle="tooltip" data-toggle="tooltip" data-html="true" title="Reputation by SteamRep.<a href='<%= dataObj.steamrepReputation.steamrepurl %>' target='_blank' rel='no-follow'>Click here</a> or the SteamRep icon above to know more">
          <i class="fas fa-question-circle"></i>
        </button>
      </h5>
      <% if(dataObj.steamrepReputation.fullReputation != ""){ %>
        <div class="reputation">
          <span class="data"></span>
        </div>
      <% }else{ %>
        <div class="reputation">
          <span class="data" style="color: #7A7D7F;">
            <svg width="25" height="20" viewBox="0 0 25 20" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right:.4rem">
              <path opacity="0.49" d="M24.6115 3.07002C24.5942 3.07208 24.5739 3.07414 24.5565 3.07414C24.5536 3.06179 24.5507 3.04945 24.5449 3.03711C24.5652 3.04739 24.5884 3.05974 24.6115 3.07002Z" fill="white"/>
              <path opacity="0.49" d="M0.454964 3.03711C0.452065 3.04945 0.446269 3.06179 0.443371 3.07414C0.425982 3.07208 0.405695 3.07208 0.388306 3.07002C0.411491 3.05974 0.434676 3.04739 0.454964 3.03711Z" fill="white"/>
              <path d="M25 6.16634C25 12.3039 19.8789 17.5923 12.5 20C5.12404 17.5943 0 12.3039 0 6.16634C0 5.10743 0.153605 4.0732 0.443427 3.07392C0.970902 3.11504 1.50997 3.13766 2.05194 3.13766C5.8457 3.13766 9.30037 2.10754 11.8885 0.421507C12.0971 0.285802 12.3 0.145985 12.4971 0C12.6942 0.143929 12.8971 0.283746 13.1057 0.421507C15.6967 2.10754 19.1485 3.13766 22.9423 3.13766C23.4871 3.13766 24.0233 3.1171 24.5508 3.07392C24.8464 4.07114 25 5.10538 25 6.16634Z" fill="#7A7D7F"/>
            </svg>                            
            no special reputation
          </span>
        </div>
      <% } %>
    </div>
  </section>
<section class="nav-wrapper">
  <div class="nav"> 
     <ul class="nav-links">
       <li class="nav-link active section-title">PROFILE OVERVIEW</li>
       <li class="nav-link section-title">FRIENDS</li>
       <li class="nav-link section-title">GAMES OWNED</li>
     </ul>
  </div>
</section>
<section class="wrapper">
  <section class="steam-ids-wrapper">
    <div class="steam-ids">
      <h5 class="section-title">STEAM ID'S</h5>
        <table class="table">
          <tbody>
            <tr>
              <td class="name-label">
                <strong>STEAMID3</strong>
              </td>
              <td class="data-label">
                <span class="data" data-full-url="<%= dataObj.objSteamIds.steam3id %>">
                  <%= dataObj.objSteamIds.steam3id %>
                </span>
                <span class="steam3id-copy copy" data-toggle="tooltip" data-placement="right" data-original-title="Copy To Clipboard">
                  <i class="far fa-clone"></i>
                </span>
              </td>
            </tr>
            <tr>
              <td class="name-label">
                <strong>STEAMID2</strong>
              </td>
              <td class="data-label"  data-full-url="<%= dataObj.objSteamIds.steam2id %>">
                <span class="data">
                  <%= dataObj.objSteamIds.steam2id %>
                </span>
                <span class="steamid2-copy copy" data-toggle="tooltip" data-placement="right" data-original-title="Copy To Clipboard">
                  <i class="far fa-clone"></i>
                </span>
              </td>
            </tr>
            <tr>
              <td class="name-label">
                <strong>STEAMID64</strong>
              </td>
              <td class=" data-label">
                <span class="data" data-full-url="<%= dataObj.objSteamIds.steam64 %>">
                  <%= dataObj.objSteamIds.steam64 %>
                </span>
                <span class="steamid64-copy copy" data-toggle="tooltip" data-placement="right" data-original-title="Copy To Clipboard">
                  <i class="far fa-clone"></i>
                </span>
              </td>
            </tr>
            <% if(dataObj.objSteamIds.customURL){ %>
            <tr>
              <td class="name-label">
                <strong>VANITY URL</strong>
              </td>
              <td class="data-label">
                <span class="data" data-full-url="<%= dataObj.objSteamIds.customURL %>" style="display:inline-block">
                  <%= dataObj.objSteamIds.customURL %>
                </span>
                <span class="vanityURL-copy copy" data-toggle="tooltip" data-placement="right" data-original-title="Copy To Clipboard">
                  <i class="far fa-clone"></i>
                </span>
                <span class="what-is-vanity ml-2" data-toggle="tooltip" data-placement="bottom" 
                data-original-title=
                "Vanity URL is a last part of a steam custom URL.
                
                For example https://steamcommunity.com/id/<%= dataObj.objSteamIds.customURL %>" style="display: inline-block;">
                  <i class="fas fa-question-circle"></i>
                </span>
              </td>
            </tr>
          <% }else{ %>
            <tr>
              <td class="name-label">
                <strong>VANITY URL</strong>
              </td>
              <td class="data-label">
                <span class="data mute">
                <em>not set</em>
                </span>
              </td>
            </tr>
          <% } %>
          </tbody>
        </table>
        </div>
  </section>
  <section class="profile-privacy-wrapper">
    <div class="profile-privacy">
      <h5 class="section-title">PROFILE PRIVACY</h5>
       <table class="table">
        <tbody>
          <tr>
            <td class="name-label">
              <strong>PRIVACY STATE</strong>
            </td>
            <td class="data-label">
              <span id="privacy-state" class="data"></span>
            </td>
          </tr>
          <tr>
            <td class="name-label">
              <strong>TRADE BAN</strong>
            </td>
            <td class="data-label">
              <span class="data" id="trade-ban"></span>
            </td>
          </tr>
          <tr>
            <td class="name-label">
              <strong>VAC BAN</strong>
            </td>
            <td class="data-label">
              <span class="data" id="vac-ban"></span>
            </td>
          </tr>
          <tr>
            <td class="name-label">
              <strong>COMMUNITY BAN</strong>
            </td>
            <td class="data-label">
              <span class="data" id="community-ban"></span>
            </td>
          </tr>
        </tbody>
      </table>
  </section>
</section>
<section class="steam-quick-links-wrapper">
  <div class="steam-quick-links">
    <h5 class=" section-title">STEAM QUICK LINKS</h5>
    <ul class="steam-quick-links-list">
      <li class="steam-quick-link">
        <a href="http://steamcommunity.com/profiles/<%= dataObj.persondata.steamid %>/inventory" target="_blank" rel="no-follow">
          Inventory
        </a>
      </li>
      <li class="steam-quick-link">
        <a href="http://steamcommunity.com/profiles/<%= dataObj.persondata.steamid %>/allcomments" target="_blank" rel="no-follow">
          Profile Comments
        </a>
      </li>
      <li class="steam-quick-link">
        <a href="http://steamcommunity.com/profiles/<%= dataObj.persondata.steamid %>/friends/common" target="_blank" rel="no-follow">
          Common Friends
        </a>
      </li>
      <li class="steam-quick-link">
        <a href="http://steamcommunity.com/profiles/<%= dataObj.persondata.steamid %>/namehistory" target="_blank" rel="no-follow"> 
         Name History
        </a>
      </li>
      <li class="steam-quick-link">
        <a href="http://steamcommunity.com/profiles/<%= dataObj.persondata.steamid %>/groups" target="_blank" rel="no-follow"> 
         Groups
        </a>
      </li>
    </ul>
  </div>
</section>
</div>
</div>






<!-- MODALS -->

<div class="modal fade" id="send-message-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" data-backdrop="static">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title section-title id="exampleModalLongTitle">NOTE</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        Send message only works for a friend of yours.
        <div class="dont-show-again mt-3">
          <input type="checkbox" name="dont-show-again-checkbox" class="dont-show-again-checkbox">
          <label for="dont-show-again-checkbox">Don't show this again</label>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="send-message-close" data-dismiss="modal">Close</button>
        <a href="steam://friends/message/<%= dataObj.persondata.steamid %>" rel="no-follow">
        <button type="button" class="send-message-ok">OK</button>
        </a>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="add-friend-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" data-backdrop="static">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title section-title id="exampleModalLongTitle">
          REQUEST SENT
        </h5>
      </div>
      <div class="modal-body">
       Added to friends.
      </div>
      <div class="modal-footer">
      </div>
    </div>
  </div>
</div>

<%- include("partials/footer.ejs"); %>

<script>
  const DoNotShowMessageAgainCheckBox = document.querySelector(".dont-show-again-checkbox");
	DoNotShowMessageAgainCheckBox.checked = false;
  let loggedUserId;
  const user = <%- JSON.stringify(user) %>
  const userKeys = Object.keys(user).length;
  if(userKeys != 0){
    loggedUserId = user.loggedUserId;
  }
  const background = document.querySelector(".profile-background");
  const dataObj = <%- JSON.stringify(dataObj) %>
  const banObj =  dataObj.banObj;
  const visibilityState = dataObj.persondata.communityvisibilitystate;
</script>

<script src="/scripts/updateBans.js"></script>
<script src="/scripts/checkOwnerShip.js"></script>
<script src="/scripts/updatePrivacy.js"></script>
<script src="/scripts/steamLevelColor.js"></script>
<script src="/scripts/updateOnlineStatus.js"></script>
<script src="/scripts/updateNavInputField.js"></script>
<script src="/scripts/updateBackground.js"></script>
<script src="/scripts/updateReputation.js"></script>