<%- include("partials/headerWithSearch.ejs"); %>

<div class="userpage-container container-fluid">
  <section class="profile-widget-wrapper">
    <div class="profile-widget">
      <h5 class="title">PROFILE WIDGET</h5>
      <ul class="widget-optns">
         <li class="active">
           <h5>PROFILE OVERVIEW</h5>
         </li>
         <li class="count">
           <h5>FRIENDS</h5>
           <span class="friend-count">383</span>
          </li>
         <li class="count">
           <h5>GAMES OWNED</h5>
           <span class="games-owned-count">10</span> 
          </li>
         <li>
           <h5>STEAM QUICK LINKS</i></h5>
          </li>
      </ul>
  </div>
  </section>
  <section class="steamname-nameavatar-wrapper">
    <div class="steam-name-container">
      <h5 class="steam-name"><%= dataObj.persondata.personaname %>
        <% if(dataObj.steamLvl) { %>
          <span class="steam-level"><%= dataObj.steamLvl.level %></span>
        <% }else{ %>
          <span class="steam-level">?</span>
        <% } %>
      </h5>
      <a href="<%= dataObj.persondata.profileurl %>" class="steam-profile-url" target="_blank" rel="noopener noreferrer">
        <%= dataObj.persondata.profileurl %>
      </a>
    </div>
    <div class="steam-avatar">
      <div class="card">
        <img class="card-img-top" src="<%= dataObj.persondata.avatarfull%>">
      </div>
    </div>
    <hr style="grid-column: 1/-1;">
  </section>
  <section class="steam-info-wrapper">
    <div class="steam-info">
      <h5 class="mb-5 section-title">ACCOUNT INFORMATION</h5>
        <div class="profile-overview-name">
          <label class="name-label"><strong>STEAM NAME</strong></label><span class="separator">-</span>
          <label class="data-label"><%= dataObj.persondata.personaname %></label>
        </div>
        <% if(dataObj.persondata.realname) { %>
          <div class="profile-overview-realname">
            <label class="name-label"><strong>REAL NAME</strong></label><span class="separator">-</span>
            <label class="data-label"><%= dataObj.persondata.realname %></label>
          </div>
        <% } else { %>
          <div class="profile-overview-realname">
            <label class="name-label"><strong>REAL NAME</strong></label><span class="separator">-</span>
            <label class="data-label private">PRIVATE</label>
          </div>
        <% }%>
        <% if(dataObj.steamLvl) { %>
          <div class="profile-overview-level">
            <label class="name-label"><strong>STEAM LEVEL</strong></label><span class="separator">-</span>
            <label  class="data-label"><%= dataObj.steamLvl.level %></label>
          </div>
        <% } else { %>
          <div class="profile-overview-level">
            <label class="name-label"><strong>STEAM LEVEL</strong></label><span class="separator">-</span>
            <label  class="data-label private">PRIVATE</label>
          </div>
        <% } %>
        <% if(dataObj.persondata.timecreated) { %>
          <div class="profile-overview-date">
            <label class="name-label"><strong>JOINED STEAM</strong></label><span class="separator">-</span>
            <% const humanDate = new Date(dataObj.persondata.timecreated*1000).toLocaleDateString("en-IN") %>
            <label class="data-label"><%= humanDate %></label>
          </div>
        <% } else{ %>
          <div class="profile-overview-date">
            <label class="name-label"><strong>JOINED STEAM</strong></label><span class="separator">-</span>
            <% const humanDate = new Date(dataObj.persondata.timecreated*1000).toLocaleDateString("en-IN") %>
            <label class="data-label private">PRIVATE</label>
          </div>
        <% } %>
        <div class="profile-overview-isonline">
          <label class="name-label"><strong>STATUS</strong></label><span class="separator">-</span>
          <label class="data-label" id="online-status"></label>
          <script>
            const status = <%- JSON.stringify(dataObj.persondata.personastate) %>;
            const dataLabel = document.getElementById("online-status");
            switch(status){
              case 0:{
                dataLabel.innerHTML = `<strong>OFFLINE</strong>`;
                dataLabel.classList.add("offline");
                break;
              }
              case 1:{
                dataLabel.innerHTML = `<strong>ONLINE</strong>`;
                dataLabel.classList.add("online");
                break;
              }
              case 2:{
                dataLabel.innerHTML = `<strong>BUSY</strong>`;
                dataLabel.classList.add("busy");
                break;
              }
              case 3:{
               dataLabel.innerHTML = `<strong>AWAY</strong>`;
               dataLabel.classList.add("away");
                break;
              }
            }
          </script>
        </div>
    </div>
  </section>
  <section class="steam-ids-wrapper">
    <div class="steam-ids">
      <h5 class="mb-5 section-title">STEAM ID'S</h5>
      <div class="profile-overview-steam3-id">
        <label class="name-label">
          <strong>STEAM3ID</strong>
        </label>
        <label class="data-label">
          <span class="separator">-</span>
          <span class="data">
            <%= dataObj.objSteamIds.steam3id %>
          </span>
          <span class="steam3-copy copy" data-toggle="tooltip" data-placement="right" data-original-title="Copy To Clipboard">
            <i class="far fa-clone"></i>
          </span>
        </label>
      </div>
      <div class="profile-overview-steam32-id">
        <label class="name-label">
          <strong>STEAMID32</strong>
        </label>
        <label class="data-label">
          <span class="separator">-</span>
          <span class="data">
            <%= dataObj.objSteamIds.steam2id %>
          </span>
          <span class="steam32-copy copy" data-toggle="tooltip" data-placement="right" data-original-title="Copy To Clipboard">
            <i class="far fa-clone"></i>
          </span>
        </label>
      </div>
      <div class="profile-overview-steam64-id">
        <label class="name-label">
          <strong>STEAMID64</strong>
        </label>
        <label class="data-label">
          <span class="separator">-</span>
          <span class="data">
            <a href="<%= dataObj.objSteamIds.steam64 %>" target="_blank" rel="noopener noreferrer">
              <%= dataObj.objSteamIds.steam64 %>
            </a>
          </span>
          <span class="steam64-copy copy" data-toggle="tooltip" data-placement="right" data-original-title="Copy To Clipboard">
            <i class="far fa-clone"></i>
          </span>
        </label>
      </div>
      <% if(dataObj.objSteamIds.customURL){ %>
        <div class="profile-overview-customURL">
          <label class="name-label">
            <strong>CUSTOM URL</strong>
          </label>
          <label class="data-label">
            <span class="separator">-</span>
            <span class="data">
              <a href="<%= dataObj.objSteamIds.customURL %>" target="_blank" rel="noopener noreferrer">
                <%= dataObj.objSteamIds.customURL %>
              </a>
            </span>
            <span class="customURL-copy copy" data-toggle="tooltip" data-placement="right" data-original-title="Copy To Clipboard">
              <i class="far fa-clone"></i>
            </span>
          </label>
        </div>
      <% } %>
    </div>
  </section>
  <section class="profile-privacy-wrapper">
    <div class="profile-privacy">
      <h5 class="mb-5 section-title">PROFILE PRIVACY</h5>
      <div class="profile-overview-privacy-state">
        <label class="name-label">
          <strong>PRIVACY STATE</strong>
        </label>
        <label class="data-label">
          <span class="separator">-</span>
          <span id="privacy-state"></span>
        </label>
      </div>
      <div class="profile-overview-tradeban">
        <label class="name-label">
          <strong>TRADE BAN</strong>
        </label>
        <label class="data-label" >
          <span class="separator">-</span>
          <span id="trade-ban"></span>
        </label>
      </div>
      <div class="profile-overview-vacban">
        <label class="name-label">
          <strong>VAC BAN</strong>
        </label>
        <label class="data-label">
          <span class="separator">-</span>
          <span id="vac-ban"></span>
        </label>
      </div>
        <div class="profile-overview-communityban">
          <label class="name-label">
            <strong>COMMUNITY BAN</strong>
          </label>
          <label class="data-label">
            <span class="separator">-</span>
            <span  id="community-ban"></span>
          </label>
        </div>
    </div>
  </section>
</div>

<script>
  let steamLevelColor;
  const dataObj = <%- JSON.stringify(dataObj) %>
  const banObj =  dataObj.banObj;
  const visibilityState = dataObj.persondata.communityvisibilitystate;
  if(visibilityState === 3 && dataObj.steamLvl){
    steamLevelColor = dataObj.steamLvl.color;
    console.log(steamLevelColor);
  }
  const navInput = document.querySelector("#url-input");
  const id = dataObj.persondata.steamid;
  navInput.value=`https://steamcommunity.com/profiles/${id}`
</script>
<script src="/scripts/updateBans.js"></script>
<script src="/scripts/updatePrivacy.js"></script>
<script src="/scripts/steamLevelColor.js"></script>

<%- include("partials/footer.ejs"); %>